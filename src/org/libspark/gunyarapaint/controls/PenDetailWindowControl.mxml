<?xml version="1.0" encoding="utf-8"?>
<mx:TitleWindow xmlns:mx="http://www.adobe.com/2006/mxml" layout="absolute" width="128" height="450" xmlns:ns1="org.libspark.gunyarapaint.controls.*" initialize="onInitialize()">
    <mx:Script>
        <![CDATA[
            import mx.containers.GridItem;
            import mx.core.Application;
            import mx.core.IFlexDisplayObject;
            import mx.effects.easing.Bounce;
            import mx.events.CloseEvent;
            import mx.events.FlexEvent;
            import mx.events.ListEvent;
            import mx.events.SliderEvent;
            import mx.managers.PopUpManager;
            
            import org.libspark.gunyarapaint.framework.Pen;
            import org.libspark.gunyarapaint.framework.events.PenEvent;
            import org.libspark.gunyarapaint.framework.modules.CircleModule;
            import org.libspark.gunyarapaint.framework.modules.DropperModule;
            import org.libspark.gunyarapaint.framework.modules.FloodFillModule;
            import org.libspark.gunyarapaint.framework.modules.FreeHandModule;
            import org.libspark.gunyarapaint.framework.modules.LineModule;
            import org.libspark.gunyarapaint.framework.modules.PixelModule;
            import org.libspark.gunyarapaint.framework.modules.TransparentFloodFill;
            import org.libspark.gunyarapaint.framework.ui.IApplication;
            import org.sepy.controls.SColorPicker;
            import org.sepy.events.SPickerEvent;
            
            private var m_palette:GridItem;
            
            // Ctrlとかのショートカットキーで変わったペンToolを戻す
            public function reset():void
            {
                var app:IApplication = IApplication(Application.application);
                if (dropperButton.selected) {
                    pen = DropperModule.DROPPER;
                }
                else if (handtoolButton.selected) {
                    currentState = MovingCanvasModule.MOVING_CANVAS;
                }
                else if (eraserButton.selected) {
                    pen = LineModule.LINE;
                    app.module.blendMode = BlendMode.ERASE;
                }
                else if (dotButton.selected) {
                    pen = PixelModule.PIXEL;
                }
                else {
                    pen = String(blendModeComboBox.value);
                    app.module.blendMode = String(blendModeComboBox.value);
                }
            }
            
            public function cancel():void
            {
                dropperButton.selected = false;
                handtoolButton.selected = false;
                eraserButton.selected = false;
                dotButton.selected = false;
                var app:IApplication = IApplication(Application.application);
                app.setModule(String(penModeComboBox.value));
            }
            
            public function get dataForPost():Object
            {
                return [palettes]; // TODO: 現在は１１1パレットのみだけど、配列化する
            }
            
            public function set application(value:IApplication):void
            {
                /*
                if (_logger.baseInfo) {
                var a:Array = _logger.baseInfo['pen_details'];
                if (a) {
                penDetail.baseImgInfo = a[0];
                for (var i:uint = 0; i < a.length; i++) {
                penDetail[i].baseImgInfo = a[i];
                }
                }
                }
                */
            }
            
            public function get palettes():Object
            {
                var palettes:Array = [];
                for (var i:uint = 1; i < 21; i++) {
                    var gridItem:GridItem = GridItem(this["gridItemPalette" + i]);
                    palettes.push(gridItem.getStyle("backgroundColor"));
                }
                return { "palettes": palettes };
            }
            
            public function set palettes(value:Object):void
            {
                for (var i:uint = 1; i < 21; i++) {
                    var palette:uint = value["palettes"][i - 1];
                    var gridItem:GridItem = GridItem(this["gridItemPalette" + i]);
                    gridItem.setStyle("backgroundColor", palette);
                }
            }
            
            public function set pen(mode:String):void
            {
                currentState = mode;
                IApplication(Application.application).setModule(currentState);
            }
            
            public function set currentColor(value:uint):void
            {
                IApplication(Application.application).module.color = value;
            }
            
            public function set currentAlpha(value:Number):void
            {
                IApplication(Application.application).module.alpha = value;
            }
            
            public function set currentThickness(value:uint):void
            {
                IApplication(Application.application).module.thickness = value;
            }
            
            private function onChangeAlpha(event:PenEvent):void
            {
                var pen:Pen = IApplication(Application.application).pen;
                var value:Number = pen.alpha;
                alphaSlider.value = value;
                drawPreview(pen.thickness, pen.color, value);
            }
            
            private function onChangeColor(event:PenEvent):void
            {
                var pen:Pen = IApplication(Application.application).pen;
                var value:uint = pen.color;
                if (m_palette != null)
                    m_palette.setStyle("backgroundColor", value);
                drawPreview(pen.thickness, value, pen.alpha);
                colRSlider.value = (value & 0xff0000) >> 16;
                colGSlider.value = (value & 0x00ff00) >> 8;
                colBSlider.value = value & 0x0000ff;
            }
            
            private function onChangeThickness(event:PenEvent):void
            {
                var pen:Pen = IApplication(Application.application).pen;
                var value:uint = pen.thickness;
                thicknessSlider.value = value;
                drawPreview(value, pen.color, pen.alpha);
            }
            
            private function onInitialize():void
            {
                var application:IApplication = IApplication(Application.application);
                blendModeComboBox.dataProvider = application.supportedBlendModes;
                //onClickPalette(1);
                // 初期値と設定値が一緒なのでイベントが飛んでこない、明示的に呼んであげる
                var pen:Pen = application.pen;
                drawPreview(pen.thickness, pen.color, pen.alpha);
                pen.addEventListener(PenEvent.ALPHA, onChangeAlpha);
                pen.addEventListener(PenEvent.COLOR, onChangeColor);
                pen.addEventListener(PenEvent.THICKNESS, onChangeThickness);
            }
            
            private function onClickPalette(index:uint):void
            {
                var palette:GridItem = this["gridItemPalette" + index];
                if (m_palette) {
                    m_palette.setStyle("borderThickness", 1);
                    m_palette.setStyle("borderColor", 0xb7babc);
                }
                palette.setStyle("borderThickness", 3);
                palette.setStyle("borderColor", 0x000000);
                m_palette = palette;
                currentColor = m_palette.getStyle("backgroundColor");
            }
            
            private function onClickColorPicker(evt:FlexEvent):void
            {
                // FIXME: お絵かきのログにパレット変更も反映したい
                var picker:SColorPicker = new SColorPicker();
                picker.selectedColor = m_palette.getStyle('backgroundColor');
                picker.title = "パレットに入れる色を選んでください。";
                
                // display the 'x' close button
                picker.showCloseButton = true;  
                // picker.add_swatch = true;
                // picker.picker_enabled = true;
                
                picker.addEventListener(CloseEvent.CLOSE, onClosePicker);
                picker.addEventListener(SPickerEvent.CHANGING, onPicker);
                picker.addEventListener(SPickerEvent.SWATCH_ADD, onPicker);
                picker.addEventListener(Event.CHANGE, onPicker);
                
                PopUpManager.addPopUp(picker, Application.application as DisplayObject, true);
                PopUpManager.centerPopUp(picker);
            }
            
            private function onClosePicker(evt:CloseEvent):void
            {
                PopUpManager.removePopUp(IFlexDisplayObject(evt.target));
            }
            
            private function onPicker(evt:Event):void
            {
                if (evt.type != SPickerEvent.CHANGING &&
                    evt.type != SPickerEvent.SWATCH_ADD &&
                    evt.type == Event.CHANGE) {
                    currentColor = SColorPicker(evt.target).selectedColor;
                    PopUpManager.removePopUp(IFlexDisplayObject(evt.target));
                }
            }
            
            private function onSelectHandTool(evt:Event):void
            {
                if (Button(evt.currentTarget).selected)
                    pen = MovingCanvasModule.MOVING_CANVAS;
                else
                    setDefaultPen();
            }
            
            private function onSelectDropper(evt:Event):void
            {
                if (Button(evt.currentTarget).selected)
                    pen = DropperModule.DROPPER;
                else
                    setDefaultPen();
            }
            
            private function onSelectEraser(evt:Event):void
            {
                if (Button(evt.currentTarget).selected) {
                    pen = FreeHandModule.FREE_HAND;
                    currentState = "eraser";
                    IApplication(Application.application).module.blendMode = BlendMode.ERASE;
                }
                else {
                    setDefaultPen();
                }
            }
            
            private function onSelectDot(evt:Event):void
            {
                if (Button(evt.currentTarget).selected)
                    pen = PixelModule.PIXEL;
                else
                    setDefaultPen();
            }
            
            private function onSelectPen(evt:ListEvent):void
            {
                cancel();
                var application:IApplication = IApplication(Application.application);
                application.setModule(String(evt.currentTarget.value));
            }
            
            private function onSelectBlendMode(evt:ListEvent):void
            {
                cancel();
                IApplication(Application.application).module.blendMode = String(evt.currentTarget.value);
            }
            
            private function onChangeColorSlider(evt:SliderEvent, mode:String):void
            {
                var c:uint = 0;
                switch (mode) {
                    case "red":
                        c += evt.value * 65536;
                        c += colGSlider.value * 256;
                        c += colBSlider.value;
                        break;
                    case "green":
                        c += colRSlider.value * 65536;
                        c += evt.value * 256;
                        c += colBSlider.value;
                        break;
                    case "blue":
                        c += colRSlider.value * 65536;
                        c += colGSlider.value * 256;
                        c += evt.value;
                        break;
                }
                currentColor = c;
            }
            
            private function drawPreview(thickness:uint, color:uint, alpha:Number):void
            {
                var g:Graphics = previewCanvas.graphics;
                g.clear();
                g.beginFill(color, alpha);
                g.drawCircle(previewCanvas.width / 2, previewCanvas.height / 2, thickness / 2);
                g.endFill();
            }
            
            private function setDefaultPen():void
            {
                pen = String(penModeComboBox.value);
                IApplication(Application.application).module.blendMode = String(blendModeComboBox.value);
            }
        ]]>
    </mx:Script>
    
    <mx:states>
        <mx:State name="dropper">
            <mx:SetProperty target="{thicknessButton1}" name="enabled" value="false"/>
            <mx:SetProperty target="{thicknessButton2}" name="enabled" value="false"/>
            <mx:SetProperty target="{thicknessButton3}" name="enabled" value="false"/>
            <mx:SetProperty target="{thicknessButton4}" name="enabled" value="false"/>
            <mx:SetProperty target="{thicknessButton5}" name="enabled" value="false"/>
            <mx:SetProperty target="{blendModeComboBox}" name="enabled" value="false"/>
            <mx:SetProperty target="{alphaSlider}" name="enabled" value="false"/>
            <mx:SetProperty target="{thicknessSlider}" name="enabled" value="false"/>
            <mx:SetProperty target="{penModeComboBox}" name="enabled" value="false"/>
            <mx:SetProperty target="{dropperButton}" name="selected" value="true"/>
            <mx:SetProperty target="{handtoolButton}" name="selected" value="false"/>
            <mx:SetProperty target="{eraserButton}" name="selected" value="false"/>
            <mx:SetProperty target="{dotButton}" name="selected" value="false"/>
        </mx:State>
        <mx:State name="floodFill">
            <mx:SetProperty target="{thicknessButton1}" name="enabled" value="false"/>
            <mx:SetProperty target="{thicknessButton2}" name="enabled" value="false"/>
            <mx:SetProperty target="{thicknessButton3}" name="enabled" value="false"/>
            <mx:SetProperty target="{thicknessButton4}" name="enabled" value="false"/>
            <mx:SetProperty target="{thicknessButton5}" name="enabled" value="false"/>
            <mx:SetProperty target="{thicknessSlider}" name="enabled" value="false"/>
            <mx:SetProperty target="{dropperButton}" name="selected" value="false"/>
            <mx:SetProperty target="{handtoolButton}" name="selected" value="false"/>
            <mx:SetProperty target="{eraserButton}" name="selected" value="false"/>
            <mx:SetProperty target="{dotButton}" name="selected" value="false"/>
        </mx:State>
        <mx:State name="movingCanvas">
            <mx:SetProperty target="{thicknessButton1}" name="enabled" value="false"/>
            <mx:SetProperty target="{thicknessButton2}" name="enabled" value="false"/>
            <mx:SetProperty target="{thicknessButton3}" name="enabled" value="false"/>
            <mx:SetProperty target="{thicknessButton4}" name="enabled" value="false"/>
            <mx:SetProperty target="{thicknessButton5}" name="enabled" value="false"/>
            <mx:SetProperty target="{penModeComboBox}" name="enabled" value="false"/>
            <mx:SetProperty target="{blendModeComboBox}" name="enabled" value="false"/>
            <mx:SetProperty target="{alphaSlider}" name="enabled" value="false"/>
            <mx:SetProperty target="{thicknessSlider}" name="enabled" value="false"/>
            <mx:SetProperty target="{paletteGrid}" name="enabled" value="false"/>
            <mx:SetProperty target="{dropperButton}" name="selected" value="false"/>
            <mx:SetProperty target="{handtoolButton}" name="selected" value="true"/>
            <mx:SetProperty target="{eraserButton}" name="selected" value="false"/>
            <mx:SetProperty target="{dotButton}" name="selected" value="false"/>
        </mx:State>
        <mx:State name="none">
            <mx:SetProperty target="{dropperButton}" name="selected" value="false"/>
            <mx:SetProperty target="{handtoolButton}" name="selected" value="false"/>
            <mx:SetProperty target="{eraserButton}" name="selected" value="false"/>
            <mx:SetProperty target="{dotButton}" name="selected" value="false"/>
        </mx:State>
        <mx:State name="pixel">
            <mx:SetProperty target="{thicknessButton1}" name="enabled" value="false"/>
            <mx:SetProperty target="{thicknessButton2}" name="enabled" value="false"/>
            <mx:SetProperty target="{thicknessButton4}" name="enabled" value="false"/>
            <mx:SetProperty target="{thicknessButton3}" name="enabled" value="false"/>
            <mx:SetProperty target="{thicknessButton5}" name="enabled" value="false"/>
            <mx:SetProperty target="{thicknessSlider}" name="enabled" value="false"/>
            <mx:SetProperty target="{blendModeComboBox}" name="enabled" value="false"/>
            <mx:SetProperty target="{dropperButton}" name="selected" value="false"/>
            <mx:SetProperty target="{handtoolButton}" name="selected" value="false"/>
            <mx:SetProperty target="{eraserButton}" name="selected" value="false"/>
            <mx:SetProperty target="{dotButton}" name="selected" value="true"/>
        </mx:State>
        <mx:State name="freeHand">
            <mx:SetProperty target="{dropperButton}" name="selected" value="false"/>
            <mx:SetProperty target="{handtoolButton}" name="selected" value="false"/>
            <mx:SetProperty target="{eraserButton}" name="selected" value="false"/>
            <mx:SetProperty target="{dotButton}" name="selected" value="false"/>
        </mx:State>
        <mx:State name="line">
            <mx:SetProperty target="{dropperButton}" name="selected" value="false"/>
            <mx:SetProperty target="{handtoolButton}" name="selected" value="false"/>
            <mx:SetProperty target="{eraserButton}" name="selected" value="false"/>
            <mx:SetProperty target="{dotButton}" name="selected" value="false"/>
        </mx:State>
        <mx:State name="circle">
            <mx:SetProperty target="{dropperButton}" name="selected" value="false"/>
            <mx:SetProperty target="{handtoolButton}" name="selected" value="false"/>
            <mx:SetProperty target="{eraserButton}" name="selected" value="false"/>
            <mx:SetProperty target="{dotButton}" name="selected" value="false"/>
        </mx:State>
        <mx:State name="eraser">
            <mx:SetProperty target="{penModeComboBox}" name="enabled" value="false"/>
            <mx:SetProperty target="{blendModeComboBox}" name="enabled" value="false"/>
            <mx:SetProperty target="{paletteGrid}" name="enabled" value="false"/>
            <mx:SetProperty target="{dropperButton}" name="selected" value="false"/>
            <mx:SetProperty target="{handtoolButton}" name="selected" value="false"/>
            <mx:SetProperty target="{eraserButton}" name="selected" value="true"/>
            <mx:SetProperty target="{dotButton}" name="selected" value="false"/>
        </mx:State>
    </mx:states>
    
    <mx:Canvas xmlns:mx="http://www.adobe.com/2006/mxml" width="108" height="410">
        
        <!-- preview -->
        <mx:Label x="3" y="10" text="ペンの状態" width="53.5"/>
        <mx:Canvas x="64.5" y="1" width="30" height="30" id="previewCanvas" borderStyle="solid" borderThickness="1" borderColor="#000000">
        </mx:Canvas>
        
        <!-- thickness -->
        <mx:Label x="3" y="28" text="太"/>
        <mx:HSlider x="16" y="28" width="87" minimum="1" maximum="30" snapInterval="1" height="12" value="3" id="thicknessSlider" change="currentThickness = event.value"/>
        <mx:Button x="2" y="47" label="極" width="20" paddingLeft="0" paddingRight="0" id="thicknessButton1" click="currentThickness = 1"/>
        <mx:Button x="23" y="47" label="細" width="20" paddingLeft="0" paddingRight="0" id="thicknessButton2" click="currentThickness = 3"/>
        <mx:Button x="44" y="47" label="中" width="20" paddingLeft="0" paddingRight="0" id="thicknessButton3" click="currentThickness = 10"/>
        <mx:Button x="65" y="47" label="太" width="20" paddingLeft="0" paddingRight="0" id="thicknessButton4" click="currentThickness = 20"/>
        <mx:Button x="86" y="47" label="極" width="20" paddingLeft="0" paddingRight="0" id="thicknessButton5" click="currentThickness = 30"/>
        
        <!-- color palette -->
        <mx:Grid id="paletteGrid" x="15" y="73" borderStyle="none" borderColor="#000000" borderThickness="1" horizontalGap="4" verticalGap="3">
            <mx:GridRow width="100%" height="100%">
                <mx:GridItem width="24" height="20" backgroundColor="#000000" id="gridItemPalette1" click="onClickPalette(1);" borderStyle="solid" cornerRadius="5">
                </mx:GridItem>
                <mx:GridItem width="24" height="20" backgroundColor="#ffffff" id="gridItemPalette2" click="onClickPalette(2);" borderStyle="solid" cornerRadius="5">
                </mx:GridItem>
                <mx:GridItem width="24" height="20" backgroundColor="#FFFFFF" id="gridItemPalette3" click="onClickPalette(3);" borderStyle="solid" cornerRadius="5">
                </mx:GridItem>
            </mx:GridRow>
            <mx:GridRow width="100%" height="100%">
                <mx:GridItem width="24" height="20" backgroundColor="#888888" id="gridItemPalette4" click="onClickPalette(4);" borderStyle="solid" cornerRadius="5">
                </mx:GridItem>
                <mx:GridItem width="24" height="20" backgroundColor="#b47575" id="gridItemPalette5" click="onClickPalette(5);" borderStyle="solid" cornerRadius="5">
                </mx:GridItem>
                <mx:GridItem width="24" height="20" backgroundColor="#FFFFFF" id="gridItemPalette6" click="onClickPalette(6);" borderStyle="solid" cornerRadius="5">
                </mx:GridItem>
            </mx:GridRow>
            <mx:GridRow width="100%" height="100%">
                <mx:GridItem width="24" height="20" backgroundColor="#c096c0" id="gridItemPalette7" click="onClickPalette(7);" borderStyle="solid" cornerRadius="5">
                </mx:GridItem>
                <mx:GridItem width="24" height="20" backgroundColor="#fa9696" id="gridItemPalette8" click="onClickPalette(8);" borderStyle="solid" cornerRadius="5">
                </mx:GridItem>
                <mx:GridItem width="24" height="20" backgroundColor="#FFFFFF" id="gridItemPalette9" click="onClickPalette(9);" borderStyle="solid" cornerRadius="5">
                </mx:GridItem>
            </mx:GridRow>
            <mx:GridRow width="100%" height="100%">
                <mx:GridItem width="24" height="20" backgroundColor="#8080ff" id="gridItemPalette10" click="onClickPalette(10);" borderStyle="solid" cornerRadius="5">
                </mx:GridItem>
                <mx:GridItem width="24" height="20" backgroundColor="#ffb6ff" id="gridItemPalette11" click="onClickPalette(11);" borderStyle="solid" cornerRadius="5">
                </mx:GridItem>
                <mx:GridItem width="24" height="20" backgroundColor="#FFFFFF" id="gridItemPalette12" click="onClickPalette(12);" borderStyle="solid" cornerRadius="5">
                </mx:GridItem>
            </mx:GridRow>
            <mx:GridRow width="100%" height="100%">
                <mx:GridItem width="24" height="20" backgroundColor="#e7e58d" id="gridItemPalette13" click="onClickPalette(13);" borderStyle="solid" cornerRadius="5">
                </mx:GridItem>
                <mx:GridItem width="24" height="20" backgroundColor="#25c7c9" id="gridItemPalette14" click="onClickPalette(14);" borderStyle="solid" cornerRadius="5">
                </mx:GridItem>
                <mx:GridItem width="24" height="20" backgroundColor="#FFFFFF" id="gridItemPalette15" click="onClickPalette(15);" borderStyle="solid" cornerRadius="5">
                </mx:GridItem>
            </mx:GridRow>
            <mx:GridRow width="100%" height="100%">
                <mx:GridItem width="24" height="20" backgroundColor="#99cb80" id="gridItemPalette16" click="onClickPalette(16);" borderStyle="solid" cornerRadius="5">
                </mx:GridItem>
                <mx:GridItem width="24" height="20" backgroundColor="#e7962d" id="gridItemPalette17" click="onClickPalette(17);" borderStyle="solid" cornerRadius="5">
                </mx:GridItem>
                <mx:GridItem width="24" height="20" backgroundColor="#FFFFFF" id="gridItemPalette18" click="onClickPalette(18);" borderStyle="solid" cornerRadius="5">
                </mx:GridItem>
            </mx:GridRow>
            <mx:GridRow width="100%" height="100%">
                <mx:GridItem width="24" height="20" backgroundColor="#f9ddcf" id="gridItemPalette19" click="onClickPalette(19);" borderStyle="solid" cornerRadius="5">
                </mx:GridItem>
                <mx:GridItem width="24" height="20" backgroundColor="#fcece2" id="gridItemPalette20" click="onClickPalette(20);" borderStyle="solid" cornerRadius="5">
                </mx:GridItem>
                <mx:GridItem width="24" height="20" backgroundColor="#FFFFFF" id="gridItemPalette21" click="onClickPalette(21);" borderStyle="solid" cornerRadius="5">
                </mx:GridItem>
            </mx:GridRow>
        </mx:Grid>
        
        <!-- tools -->
        <mx:Button id="colorPickerButton" x="21.5" y="235" label="色選択画面" width="65" paddingLeft="0" paddingRight="0" buttonDown="onClickColorPicker(event)"/>
        <mx:Button id="dropperButton" x="5" y="260" toggle="true"  icon="@Embed(source='../../../../../imgs/icon_dropper.png')" width="22" paddingLeft="0" paddingRight="0" change="onSelectDropper(event)"/>
        <mx:Button id="handtoolButton" x="31" y="260" toggle="true"  icon="@Embed(source='../../../../../imgs/icon_hand_open.png')" width="22" paddingLeft="0" paddingRight="0" change="onSelectHandTool(event)"/>
        <mx:Button id="eraserButton" x="56" y="260" toggle="true" label="消" width="22" paddingLeft="0" paddingRight="0" change="onSelectEraser(event)"/>
        <mx:Button id="dotButton" x="81" y="260" toggle="true" label="ド" width="22" paddingLeft="0" paddingRight="0" change="onSelectDot(event)"/>
        
        <!-- alpha -->
        <mx:Label x="3" y="285" text="透"/>
        <mx:Label x="1" y="295" text="{alphaSlider.value}" width="28" enabled="false" fontSize="8"/>
        <mx:HSlider id ="alphaSlider" x="20" y="282" width="87" minimum="0.05" maximum="1" snapInterval="0.05" value="1" change="currentAlpha = event.value"/>
        
        <!-- rgb -->
        <mx:Label x="3" y="304" text="R"/>
        <mx:Label x="1" y="313" text="{colRSlider.value}" width="20" textAlign="right" enabled="false" fontSize="8"/>
        <mx:HSlider id ="colRSlider" x="20" y="301" width="87" minimum="0" maximum="255" snapInterval="1" change="onChangeColorSlider(event, 'red')" fillColors="#ff0000"/>
        <mx:Label x="3" y="319" text="G"/>
        <mx:Label x="1" y="328" text="{colGSlider.value}" width="20" textAlign="right" enabled="false" fontSize="8"/>
        <mx:HSlider id ="colGSlider" x="20" y="316" width="87" minimum="0" maximum="255" snapInterval="1" change="onChangeColorSlider(event, 'green')" fillColors="#00ff00"/>
        <mx:Label x="3" y="334" text="B"/>
        <mx:Label x="1" y="343" text="{colBSlider.value}" width="20" textAlign="right" enabled="false" fontSize="8"/>
        <mx:HSlider id ="colBSlider" x="20" y="331" width="87" minimum="0" maximum="255" snapInterval="1" change="onChangeColorSlider(event, 'blue')" fillColors="#0000ff"/>
        
        <!-- line method/blend mode -->
        <mx:ComboBox id="penModeComboBox" x="6" y="356" width="96" change="onSelectPen(event)">
            <mx:ArrayCollection>
                <mx:Object label="手書き" data="{FreeHandModule.FREE_HAND}" />
                <mx:Object label="直線" data="{LineModule.LINE}" />
                <mx:Object label="円" data="{CircleModule.CIRCLE}" />
                <mx:Object label="ペイント" data="{FloodFillModule.FLOOD_FILL}" />
                <mx:Object label="透明ペイント" data="{TransparentFloodFill.TRANSPARENT_FLOOD_FILL}" />
                <!--
                <mx:Object label="スポイト" data="" />
                <mx:Object label="四角" data="" />
                <mx:Object label="楕円" data="" />
                <mx:Object label="角丸四角" data="" />
                -->
            </mx:ArrayCollection>
        </mx:ComboBox>
        <mx:ComboBox id="blendModeComboBox" x="6" y="381" width="97" change="onSelectBlendMode(event)">
        </mx:ComboBox>
    </mx:Canvas>
    <!-- palette select animation -->
    <mx:Resize id="selectPaletteEffect" widthFrom="24" widthTo="24"
               heightFrom="20" heightTo="20"
               easingFunction="{Bounce.easeOut}" />
</mx:TitleWindow>
